<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>أي شخصية من Game of Thrones أنت؟</title>
<style>
  :root { --bg:#0d1117; --card:#161b22; --text:#e6edf3; --accent:#2ea043; --muted:#8b949e; }
  body{margin:0;font-family:Tahoma,Arial,system-ui,sans-serif;background:var(--bg);color:var(--text);padding:16px}
  .wrap{max-width:860px;margin:0 auto}
  h1{font-size:22px;margin:0 0 12px}
  .sub{color:var(--muted);margin-bottom:18px}
  .question{background:var(--card);border-radius:14px;padding:14px;margin:10px 0}
  .qtitle{font-weight:bold;margin:0 0 8px}
  label{display:block;line-height:1.6;padding:6px 10px;border-radius:10px;cursor:pointer}
  label:hover{background:#1f2530}
  input[type="radio"]{accent-color:var(--accent);margin-left:8px;margin-right:4px;transform:scale(1.15)}
  .btn{display:inline-block;background:var(--accent);color:#fff;border:none;border-radius:12px;padding:12px 16px;font-size:16px;cursor:pointer;margin-top:10px}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .result{background:var(--card);border-radius:16px;padding:18px;margin-top:16px;text-align:center}
  .hero{width:160px;height:160px;border-radius:18px;display:block;margin:0 auto 10px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
  .chips{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:8px}
  .chip{background:#212734;color:var(--muted);padding:6px 10px;border-radius:12px;font-size:12px}
  .footer{color:var(--muted);font-size:12px;margin-top:12px;text-align:center}
  .progress{height:6px;background:#232a36;border-radius:8px;overflow:hidden;margin:6px 0 10px}
  .bar{height:100%;width:0;background:var(--accent);transition:width .25s linear}
  .share{display:flex;gap:8px;justify-content:center;margin-top:10px}
  .sbtn{background:#30363d;border:1px solid #3d444d;color:#fff;border-radius:10px;padding:10px 12px;font-size:14px}
</style>
</head>
<body>
<div class="wrap">
  <h1>أي شخصية من <span style="white-space:nowrap">Game of Thrones</span> أنت؟</h1>
  <div class="sub">اختبار ممتع من 10 أسئلة. اختر الإجابة الأقرب لك وشوف نتيجتك مع صورة ووصف ✨</div>
  <div class="progress"><div class="bar" id="bar"></div></div>
  <form id="quiz"></form>
  <button class="btn" id="submitBtn" type="button">أظهر النتيجة</button>
  <div id="result" class="result" style="display:none"></div>
  <div class="footer">تلميح: يمكنك استبدال صورة أي شخصية برابط خارجي عبر كائن <code>images</code> داخل الكود.</div>
</div>

<script>
/* ========= 1) تعريف الشخصيات + وصف مختصر ========= */
const characters = {
  "جون سنو": "شجاع، وفيّ، قائد هادئ يضع مصلحة الجميع قبل نفسه.",
  "دينيريس تارجارين": "طموحة وكاريزمية، تؤمن بالعدالة وكسر القيود.",
  "تيريون لانيستر": "ذكي ولسانه حاد، يعتمد على الدهاء بدل القوة.",
  "سيرسي لانيستر": "حازمة ولا ترحم، العائلة والعرش فوق كل شيء.",
  "جيمي لانيستر": "فارس ماهر، يمزج الولاء بصراع داخلي بين الشرف والحب.",
  "آريا ستارك": "مستقلة لا تخاف، تتعلم بسرعة وتعرف كيف تنجو.",
  "سانسا ستارك": "دبلوماسية، تتقن اللعبة السياسية مع صبر وحكمة.",
  "بران ستارك": "هادئ وبصير، ينظر للأمور من منظور أوسع من الجميع.",
  "نيد ستارك": "شهم وشريف، يلتزم بالمبادئ مهما كان الثمن.",
  "سامويل تارلي": "قلبه طيب ومثابر، المعرفة سلاحه الأقوى.",
  "ساندور كليجان (الكلب)": "صارم وخشن لكنه يملك حس عدالة خاص.",
  "جورا مورمونت": "مخلص للغاية، شجاع ويضع من يحبهم أولًا.",
  "رامزي بولتون": "قاسٍ وسادي، يستمتع بالتلاعب والخداع.",
  "تايون لانيستر": "استراتيجي بارد الأعصاب، الأولوية للقوة والنفوذ.",
  "روبيرت براثيون": "عفوي وصاخب، محارب ممتاز لكنه يمل السياسة."
};

/* ========= 2) صور مضمونة: أفاتارات SVG تُولَّد محليًا =========
   يمكنك وضع روابط حقيقية لأي شخصية هنا (اختياري).
   مثال: images["جون سنو"] = "https://.../jon.jpg"  */
const images = {
  // "جون سنو": "https://your-cdn.com/jon.jpg"
};

/* مولّد أفاتار SVG (خلفية متدرجة + حروف الاسم) */
function avatarDataURI(name){
  const initials = name.split(/\s+/).map(w=>w[0]).join('').slice(0,3);
  // توليد لونين ثابتين من الاسم
  let h = 0;
  for (let i=0;i<name.length;i++) h = (h*33 + name.charCodeAt(i)) % 360;
  const h2 = (h+40)%360;
  const svg =
`<svg xmlns='http://www.w3.org/2000/svg' width='320' height='320'>
  <defs>
    <linearGradient id='g' x1='0' x2='1' y1='0' y2='1'>
      <stop offset='0%' stop-color='hsl(${h},60%,35%)'/>
      <stop offset='100%' stop-color='hsl(${h2},70%,30%)'/>
    </linearGradient>
  </defs>
  <rect width='100%' height='100%' fill='url(#g)'/>
  <text x='50%' y='55%' font-family='Tahoma,Arial' font-size='110' fill='white' text-anchor='middle' dominant-baseline='middle' style='paint-order:stroke; stroke:black; stroke-width:6;'>
    ${initials}
  </text>
</svg>`;
  return "data:image/svg+xml;utf8," + encodeURIComponent(svg);
}

/* ========= 3) الأسئلة (10 أسئلة) ========= */
const questions = [
  { q:"في لحظة قرار مصيرية، شو يغلب؟",
    map:{ "جون سنو":"الشرف والصدق", "سيرسي لانيستر":"المصلحة للعائلة",
          "تيريون لانيستر":"المنطق والحيلة", "دينيريس تارجارين":"العدالة حتى لو بالقوة" } },
  { q:"لو فقدت الدعم من أقرب الناس، بتعمل؟",
    map:{ "آريا ستارك":"أشدّ حالي وأكمل وحدي", "سانسا ستارك":"أبني تحالفات ذكية",
          "جورا مورمونت":"أظل وفيّ على أي حال", "رامزي بولتون":"أستغل الضعف لصالحـي" } },
  { q:"أسلوبك بالقيادة؟",
    map:{ "جون سنو":"قدوة قبل الأوامر", "تايون لانيستر":"حزم وانضباط",
          "دينيريس تارجارين":"إلهام وكاريزما", "روبيرت براثيون":"حماسة وعفوية" } },
  { q:"أفضل سلاح بالنسبة لك؟",
    map:{ "جيمي لانيستر":"السيف", "آريا ستارك":"الخفة والتدريب",
          "تيريون لانيستر":"الكلمات والعقل", "ساندور كليجان (الكلب)":"القوة المباشرة" } },
  { q:"كيف تتعامل مع الظلم؟",
    map:{ "دينيريس تارجارين":"أكسره ولو احترق الطريق", "بران ستارك":"أفهم الصورة الأكبر",
          "نيد ستارك":"أواجهه بالقانون والشرف", "سيرسي لانيستر":"أنتقم أضعافًا" } },
  { q:"لما تخطط لمعركة/مواجهة:",
    map:{ "تايون لانيستر":"خطة طويلة المدى", "جون سنو":"أخذ رأي من أثق فيهم",
          "رامزي بولتون":"خداع نفسي قذر", "تيريون لانيستر":"ابتكار حلول غير متوقعة" } },
  { q:"الدافع الأقوى لشخصيتك:",
    map:{ "جورا مورمونت":"الولاء", "سانسا ستارك":"الكرامة والمكانة",
          "سامويل تارلي":"المعرفة والحقيقة", "روبيرت براثيون":"المتعة واللحظة" } },
  { q:"وضعك مع السياسة؟",
    map:{ "تيريون لانيستر":"أحبها وأجيدها", "سانسا ستارك":"أتقنها بصمت",
          "جون سنو":"أتجنبها قدر الإمكان", "سيرسي لانيستر":"هي ملعبـي المفضل" } },
  { q:"عندك سر خطير…",
    map:{ "بران ستارك":"أحتفظ به للمصلحة العامة", "دينيريس تارجارين":"أستخدمه لتغيير الموازين",
          "رامزي بولتون":"أبتزّ به الآخرين", "نيد ستارك":"أواجه الحقيقة مهما كانت" } },
  { q:"صفة تلخصك أكثر:",
    map:{ "جون سنو":"الشجاعة", "دينيريس تارجارين":"الطموح",
          "تيريون لانيستر":"الذكاء", "ساندور كليجان (الكلب)":"الصلابة",
          "سامويل تارلي":"المثابرة" } }
];

/* ========= 4) بناء النموذج ========= */
const quiz = document.getElementById("quiz");
const bar  = document.getElementById("bar");
questions.forEach((item, idx)=>{
  const box = document.createElement("div");
  box.className="question";
  const title = document.createElement("div");
  title.className="qtitle";
  title.textContent = (idx+1)+". "+item.q;
  box.appendChild(title);
  Object.entries(item.map).forEach(([char,label])=>{
    const id = `q${idx}_${char}`;
    const wrap = document.createElement("label");
    wrap.innerHTML = `<input type="radio" name="q${idx}" id="${id}" value="${char}"> ${label}`;
    box.appendChild(wrap);
  });
  quiz.appendChild(box);
});

quiz.addEventListener("change",()=>{
  const answered = [...quiz.querySelectorAll('input[type="radio"]:checked')].length;
  bar.style.width = (answered/questions.length*100).toFixed(0)+"%";
});

/* ========= 5) حساب النتيجة + عرض الصورة والوصف ========= */
document.getElementById("submitBtn").addEventListener("click", ()=>{
  const chosen = [...quiz.querySelectorAll('input[type="radio"]:checked')];
  if (chosen.length < questions.length){ alert("جاوب على جميع الأسئلة أولًا ✅"); return; }

  // تجميع النقاط
  const score = {};
  chosen.forEach(inp => { score[inp.value] = (score[inp.value]||0) + 1; });

  // اختيار أعلى شخصية
  let best = null, bestVal = -1;
  Object.entries(score).forEach(([k,v])=>{ if(v>bestVal){ best=k; bestVal=v; }});

  // تجهيز الصورة (رابط خارجي إن وُجد، وإلا أفاتار مولَّد)
  const imgSrc = images[best] || avatarDataURI(best);

  // كلمات توصيفية لطيفة (تظهر كشرائح)
  const tags = (characters[best]||"").split(/[,،]/).map(s=>s.trim()).filter(Boolean);

  // بناء النتيجة
  const res = document.getElementById("result");
  res.style.display="block";
  res.innerHTML = `
    <img class="hero" src="${imgSrc}" alt="${best}">
    <h2>أنت تشبه: ${best} 👑</h2>
    <p style="margin:6px 0 2px">${characters[best]||""}</p>
    <div class="chips">${tags.map(t=>`<span class="chip">${t}</span>`).join('')}</div>
    <div class="share">
      <button class="sbtn" onclick="shareResult('${best}')">مشاركة النتيجة</button>
      <button class="sbtn" onclick="window.scrollTo({top:0,behavior:'smooth'})">أعد المحاولة</button>
    </div>
  `;
});

// مشاركة (يدعم Web Share API إن متوفر)
function shareResult(name){
  const text = `نتيجتي في اختبار Game of Thrones: أنا أشبه ${name}! جرّب الاختبار 👇`;
  if (navigator.share){
    navigator.share({title:"اختبار Game of Thrones", text});
  } else {
    prompt("انسخ النص وشاركه:", text);
  }
}
</script>
</body>
</html>
